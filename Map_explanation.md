# Map.jsx 구성요소 및 기능 설명

## 임포트 섹션 (1-45줄)

- **React 관련 라이브러리**: useEffect, useRef, useCallback, forwardRef 등 React 훅과 기능
- **OpenLayers 핵심 요소**: Map, View, 좌표계 변환, 레이어, 소스 등
- **맵 객체 관련 컴포넌트**: GCPObjects, LandingObjects, MissionObjects
- **UI 버튼 컴포넌트**: AddButton, DeleteButton, MoveButton 등
- **OpenLayers 인터랙션**: Select, Translate, Draw, Snap 등 사용자 상호작용 기능
- **스타일 관련 요소**: Style, Circle, Fill, Stroke, Text, Icon 등 시각적 표현
- **Material UI 컴포넌트**: Dialog, Button, Radio 등 UI 요소

## 상수 정의 (47-82줄)

- **MAP_CONFIG**: 초기 중심좌표(서울시청), 확대/축소 레벨, 투영체계, 타일 URL 등 지도 기본 설정
- **POINT_STYLE**: 선택된 포인트와 기본 포인트의 시각적 스타일 (크기, 색상, 테두리 등)

## 컴포넌트 정의 (84-124줄)

- **MapTest 컴포넌트**: forwardRef를 사용해 부모에서 접근 가능한 지도 컴포넌트
- **Props**: gcpData, modifiedData, 이벤트 핸들러 함수들, 현재 탭 정보 등
- **Refs 정의**: 맵, 레이어, 소스, 인터랙션 등 참조 변수들
- **상태 변수**: 미션 모달, 그리기 타입, 선택된 피처 ID 등

## 핵심 함수 정의 (125-192줄)

- **핸들러 함수**: 미션 버튼 클릭, 모달 닫기, 그리기 타입 변경 등
- **getCurrentLayer**: 현재 탭에 맞는 레이어 반환
- **handleToggleAddingMode**: 포인트 추가 모드 토글 및 다른 모드 비활성화
- **handleToggleDeletingMode**: 포인트 삭제 모드 토글 및 다른 모드 비활성화
- **handleToggleMovingMode**: 포인트 이동 모드 토글 및 다른 모드 비활성화

## 지도 초기화 useEffect (193-452줄)

1. **레이어 생성**: GCP 레이어, 이착륙 레이어 생성
2. **OpenLayers 맵 객체 생성**: 컨트롤, 레이어, 뷰 설정
3. **선택 및 이동 상호작용 설정**: 포인트 선택, 이동 기능 구현
4. **이벤트 리스너 등록**: 이동 완료 시 좌표 업데이트 및 콜백 호출
5. **폴리곤 레이어 및 인터랙션 초기화**: 폴리곤 그리기 준비
6. **꼭짓점 마커 레이어 추가**: 꼭짓점 표시용 레이어 설정
7. **초기 GCP 데이터 표시**: 데이터가 있으면 지도에 피처로 추가
8. **맵 클릭 이벤트 핸들러 설정**:
   - 포인트 추가 모드: 클릭 위치에 새 포인트 생성
   - 포인트 삭제 모드: 클릭한 포인트 삭제
9. **선택 이벤트 처리**: 피처 선택 시 콜백 호출
10. **정리 함수**: 컴포넌트 언마운트 시 이벤트 리스너 및 인터랙션 제거

## 데이터 및 상태 관리 useEffects (453-547줄)

- **gcpData 변경 시 피처 업데이트**: 저장 버튼 클릭 시 지도에 데이터 갱신
- **탭 변경 시 선택 초기화**: 탭 변경 시 선택된 피처 초기화
- **탭 변경 시 레이어 토글**: 현재 탭에 맞는 레이어만 표시 (GCP/이착륙/미션)

## 미션 관련 기능 (548-614줄)

- **startMissionDraw**: 미션 그리기 시작 함수
  1. 기존 그리기/스냅 인터랙션 제거
  2. 새 그리기 인터랙션 생성 및 추가
  3. 그리기 완료 이벤트 처리 (objectId 할당, 부모 컴포넌트에 알림)
- **handleMissionModalConfirm**: 미션 모달 확인 버튼 클릭 처리

## 외부에서 접근 가능한 메서드 (615-903줄)

- **addPoint**: 지도에 포인트 추가
- **updateFeature**: 피처 정보(이름, 위치) 업데이트
- **deleteFeature**: 피처 삭제
- **deleteMissionFeature**: 미션 피처 삭제
- **highlightFeatureAndPan**: 피처 강조 표시 및 중심 이동
  - 임무 탭: 폴리곤, 라인, 포인트 등 다양한 형태 지원
  - GCP/이착륙 탭: 포인트 강조 표시

## 피처 선택 및 꼭짓점 마커 관리 (904-969줄)

- **Feature 클릭 이벤트 처리**: 피처 선택 및 그리드 연동
- **updateVertexMarkers 함수**: 선택된 피처의 꼭짓점 마커 동기화

## 변환 상호작용 및 키보드 이벤트 처리 (970-1350줄)

- **TransformInteraction 설정**: 객체 변환(이동, 회전, 크기 조정) 기능
- **키보드 이벤트 처리**: Delete 키로 선택된 피처 삭제 등
- **미션 선택 및 변환 기능**: 미션 객체의 선택 및 변환 처리

## 렌더링 (1351-1373줄)

- **UI 요소 렌더링**: 지도 컨테이너, 버튼, 모달 등
- **버튼 배치**: 포인트 추가, 삭제, 이동 버튼 등
- **모달 다이얼로그**: 미션 그리기 타입 선택 인터페이스
